<!DOCTYPE html>
<html>
    <head>
        <title>Poker</title>

        <!-- add the favicon to the browser tab -->
        <link rel="icon" type="image/png" href="static/images/favicon.png"/>

        <!-- import styles -->
        <link rel="stylesheet" type="text/css" href="static/css/main.css" />

        <!-- import third-party libraries (via CDN) -->
        <script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
        <script type="text/javascript" src="lib/underscore-min.js"></script>
    </head>
    <body>
        <h1>Poker</h1>


        <div id="users"></div>


        <script src="https://www.gstatic.com/firebasejs/3.6.1/firebase.js"></script>
        <script>
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyBQce0nrlup-6npCVtCDprkAnluxBAsJ_g",
                authDomain: "poker-cfe40.firebaseapp.com",
                databaseURL: "https://poker-cfe40.firebaseio.com",
                storageBucket: "poker-cfe40.appspot.com",
                messagingSenderId: "654567084079"
            };
            firebase.initializeApp(config);

            // Get a reference to the database service
            var db = firebase.database();

            // define the user data.
            var userId = "k39chen";
            var userData = {
                id: "k39chen",
                email: "k39chen@gmail.com",
                firstName: "Kevin",
                lastName: "Chen"
            };
            // add the user k39chen to the database
            db.ref("users/" + userId).set(userData);

            db.ref("users").on("value", function(snap) {
                var usersData = snap.val();
                console.log(usersData);
            });

            db.ref("users/" + userId).on("value", function(snap) {
                var userData = snap.val();
                console.log(userData);
                renderUser(userData);
            });

            function renderUser(userData) {
                var $users = $("#users");
                var $user = $("<div class='user' />").appendTo($users);

                _.each(userData, function(value, property) {
                    var $row = $("<div class='row' />")
                        .append("<span class='property'>" + property + "</span>: ")
                        .append("<span class='value'>" + value + "</span>")
                        .appendTo($user)
                });
            }
        </script>
    </body>
</html>
